<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
        <link rel="stylesheet" href="../css/profile_style.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <style>
            body {
                background-color: rgb(34, 33, 33);
            }
            .image img {
                border-radius: 20%;
            }
            .btn {
                height: 200px;
                width: 200px;           
            }
            .btn-secondary {
                border-radius: 20%;
            }


            div {
                margin-bottom: 16px;
            }

            #video-container {
                line-height: 0;
            }

            #video-container.example-style-1 .scan-region-highlight-svg,
            #video-container.example-style-1 .code-outline-highlight {
                stroke: #64a2f3 !important;
            }

            #video-container.example-style-2 {
                position: relative;
                width: max-content;
                height: max-content;
                overflow: hidden;
            }
            #video-container.example-style-2 .scan-region-highlight {
                border-radius: 30px;
                outline: rgba(0, 0, 0, .25) solid 50vmax;
            }
            #video-container.example-style-2 .scan-region-highlight-svg {
                display: none;
            }
            #video-container.example-style-2 .code-outline-highlight {
                stroke: rgba(255, 255, 255, .5) !important;
                stroke-width: 15 !important;
                stroke-dasharray: none !important;
            }

            #flash-toggle {
                display: none;
            }

            hr {
                margin-top: 32px;
            }
            input[type="file"] {
                display: block;
                margin-bottom: 16px;
            }

        </style>
    </head>
    <body>
        <div class="container mt-4 mb-4 p-3 d-flex justify-content-center">
            <div class="card p-4">
                <div class=" image d-flex flex-column justify-content-center align-items-center">
                    
                    <div id="video-container">
                        <video id="qr-video"></video>
                    </div>

                    <div class=" d-flex mt-2"> 
                        <button class="btn1 btn-dark" id="start-button">Leer QR</button> 
                        <button class="btn1 btn-dark" id="stop-button" hidden>Detener</button> 
                    </div>
                    <br>   
                    <span id="cam-qr-result">None</span>

                    <div class="gap-3 mt-3 icons d-flex flex-row justify-content-center align-items-center"> 
                        <span><i class="fa fa-twitter"></i></span> 
                        <span><i class="fa fa-facebook-f"></i></span> 
                        <span><i class="fa fa-instagram"></i></span> 
                        <span><i class="fa fa-linkedin"></i></span> 
                    </div>
                    
                    
                </div>
            </div>
        </div>
    </body>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    
    <!--script src="js/html5-qrcode.min.js"></script-->
    <!--script src="https://unpkg.com/html5-qrcode@2.0.9/dist/html5-qrcode.min.js"></script-->
    
    <script src="../js/qr-scanner.umd.min.js"></script>
    <!--script src="../js/qr-scanner.min.js"></script-->

    <script>
        //import QrScanner from "../js/qr-scanner.min.js";
        const video = document.getElementById('qr-video');
        const videoContainer = document.getElementById('video-container');
        const camQrResult = document.getElementById('cam-qr-result');

        document.getElementById('start-button').addEventListener('click', () => {
            scanner.start();
            document.getElementById('start-button').hidden = false;
            document.getElementById('stop-button').hidden = true;
        });

        document.getElementById('stop-button').addEventListener('click', () => {
            scanner.stop();
        });

        function setResult(label, result) {
            console.log(result.data);
            scanner.stop();
            window.location.href = "/profile";
        }

        const scanner = new QrScanner(video, result => setResult(camQrResult, result), {
            onDecodeError: error => {
                camQrResult.textContent = error;
                camQrResult.style.color = 'inherit';
            },
            highlightScanRegion: true,
            highlightCodeOutline: true,
            disallowCanvasResizing: true,

        });

    </script>
</html>